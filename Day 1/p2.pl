use feature 'say';
use POSIX 'floor';

my $i = <<'EOF';
99603
121503
86996
72052
112039
106616
123581
123171
52480
68686
66395
102661
110250
73289
105725
123802
75488
79426
98634
76095
50852
141405
112388
72180
103300
124602
104531
94751
63270
139027
145939
62275
91812
74751
144010
60221
62821
51080
149802
53067
102574
131339
78942
88430
105314
72764
55214
79095
97458
68699
106974
141492
57673
141866
139355
134222
52145
83293
144322
70741
107873
123638
141011
133249
99065
120480
100767
136550
147323
146988
65583
141287
53097
50662
121124
94886
59344
93981
112492
149136
56647
96430
63968
117987
138475
125958
74967
64480
104644
70273
50671
147116
147101
89096
94697
83282
74533
68418
145578
59032
EOF

our $sum = 0;
sub _get_total {
    my $mass = shift @_;
    my $total = 0;
    my $fuel = floor($mass / 3) - 2;
    if( $fuel > 0 ) {
        $total += _get_total($fuel);
        $total += $fuel;
    }
    return $total;
}

foreach my $line ( split(/\n/,$i) ) {
   $sum += _get_total($line);
}

say $sum;